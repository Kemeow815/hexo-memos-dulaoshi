---
title: DDoS 的攻击鉴赏下篇
tags:
  - 攻击
categories:
  - 网络安全
date: 2023-09-20 00:00:00
---

> 

<!-- more -->

## 

除了对目标的宽带资源进行霸占

以达到DDoS攻击的效果以外

因为TCP协议中有连接的概念

所以还可以攻击服务器的连接资源


服务器和客户端每次建立一个TCP连接时

需要经历三次握手

然后把连接信息放入到连接表中进行维护

而连接表的大小是有限的

我们可以让发起攻击的设备直接发起大量的TCP连接

从而占满服务器的这个连接表

而无法响应后续的TCP连接请求

从而达到DDoS攻击的效果

这种直接的方式也称之为TCP洪水

但因为有三次握手的存在

所以TCP洪水无法通过伪造IP隐藏自己

在建立连接时

如果我们在第一次握手中伪造了IP

那么服务器向客户端发送数据的第二次握手就无法到达

相当于你给别人写了一封伪造发现地址的信

那么你是不可能收到回信的

因此连接无法建立

但是可以在建立连接的三次握手本身上做文章

比如只发送SYN

不进行后续回答这样虚晃一枪的SYN洪水

这样做的好处是

如果不回答攻击目标的SYN+ACK数据

那么考虑到可能是网络的环境问题

TCP协议中有重传机制

对方会多次尝试发送SYN+ACK直到超时

但问题是

这时候受害者会不断的向攻击者发送SYN+ACK

比如重试10次

那这就相当于我们每攻击目标一次

对方就会回击10次

所谓杀敌一千自损一万也不过如此

所以SYN洪水攻击一般都会伪造IP

或是一个不存在的IP让受害者八箭四鼓心茫然

或是某个真实倒霉蛋的IP把祸水东移

同样的思路在TCP协议中也可以通过反射发起攻击

向各个反射器发送SYN

并把发现地址伪造成攻击目标的IP

这样大量的SYN+ACK数据就会从各个反射器上涌入攻击目标

当然这种攻击方式因为无法在目标上建立连接

所以还是在攻击网络带宽属于是

而针对TCP协议还有一种巧妙的攻击手段

RST洪水攻击

在TCP协议中一般用四次挥手结束连接

但为了防止出现异常

一方可以发送一个RST数据强制切断连接

这样我们让攻击设备不断尝试伪造各种IP地址

并发送RST数据进行绑打

一旦IP和其他的一些配置和某个正常用户匹配上

就能够切断正常用户和服务器之间的连接

这种攻击方式更针对用户

比如在一场网络游戏对战中

在获悉对手的IP地址之后

就可以不断切断对方的游戏设备和服务器的连接

以干扰他的正常游戏

不论是利用IP UDP还是TCP协议攻击

针对的都是网络和连接资源

还有一种直接针对服务器内部资源的攻击方式

消耗目标的计算和IO

正如我们开头所说

一次网络访问的过程是这样的

客户端通过网络线路向远程服务器请求内容

服务器按照客户端的需求或查询或计算出相应的数据

再通过网络线路反送给客户端

作为在第五层的用户

一般在网上冲浪时

接触的都是应用层中像HTTP这样的协议

比如我们访问B站的时候

在浏览器输入http3w.bilibili.com

所以我们可以对一个站点发起HTTP洪水攻击

比如利用站点的搜索功能

不断的生成大量的关键词送入查询地址

因为HTTP作为用户直接发起的涉及具体业务的请求

服务器在收到请求后

需要进行像数据库查询这样的IO操作

所以这样的攻击手法会对目标产生更大的消耗

当然HTTP洪水攻击有个问题

那就是不能伪造IP地址

因为HTTP协议实际上是基于TCP协议的

需要经历三次握手的过程

所以常见的方法是借助网络代理主机

得到不同的真实IP发起攻击

这对于一次资金充足

有计划有组织的攻击来说

并不是一件难事

DDoS攻击还有一些其他的方式

这里就不再一一列举

但所谓有攻就有防

哪里有压迫哪里就有反抗

所以有哪些应对DDoS攻击的方法呢

目前有两种大的方向

激进的手术治疗和稳妥的保守治疗

捣毁僵尸网络并让用户做好个人防护

避免被感染成为僵尸设备是一种很好的方法

但这是需要长期持续进行的方案

我们举两个典型的在技术层面上

根治DDoS攻击的方法

从DDoS的攻击原理上我们可以看出来

伪造IP地址是DDoS攻击的核心技术之一

一旦攻击者无法伪造IP地址

那几乎就形同种种枯骨

强弩之末

而治理伪造IP的方法并不复杂

现代互联网的下游

也就是用户设备接入的这一端

设备通过路由接入互联网服务提供商

所以只要让路由设备检测IP

把原地址IP不属于本路由所在的网端的数据都过滤掉

这样试图伪造IP的流量就无法发出

还有一个稍微复杂一点的分布式过滤方案

我们知道庞大的互联网中

不同的网端依靠路由把彼此连接

一个数据从假发送到已

它的IP可以伪造成笔

但是它所经过的真实路线则不可能作假

换句话说

从笔到已的数据不可能经过路由A

但这个伪造IP的数据从假发送到已却经过了A

如果路由能够根据IP地址的路径逻辑检测出矛盾

那么就可以过滤掉这样的流量

从而消灭伪造IP的伎俩

当然一个涉及到用户服务商设备商

甚至是监管部门的多方技术方案

那就不能只是一个技术问题

出于商业上投入产出的考虑

往往是目以陈舟击中难返

这两种方案很难被执行

只有有一定影响力的大型企业和机构

才能撬动这种涉及全球的多方合作

对于中小企业甚至是刚起步的创意者来说

并不现实

所以人们提出了一些大家都能够承担得起的

缓解DDoS攻击的保守治疗方案

我们也列举两个目前使用比较多的方法

DDoS攻击的可怕之处在于第一个D分布式

当一个僵尸网络对目标发起攻击时

很难处理这些来自四面八方的流量

但所谓事一常计以至矣

敌人可以群起而攻之

那作为守法公民

我们又何尝不能联合起来

把一个网络服务的流量分散到不同的地方

从而稀释攻击的流量

比如目前各个站点普遍采用的CDN技术

把一些相对静态的资源作为缓存

分发给各个CDN节点

用户在请求的时候从最近的节点返回

这样就在一定程度上缓解了DDoS的攻击

当然CDN的缓解作用比较有限

有一种目前比较主流的

并有一些厂商专门为此开发产品的方案

流量清洗

我们在服务器前架设一台流量清洗设备

这个设备就像一个身高马大的保镖和秘书

帮我们对抗DDoS流量

比如面对TCP协议的SYN洪水DDoS攻击

客户端发起的SYN先经过清洗设备

由清洗设备回复SYN+ACK

如果对方硬打了那说明是正常的流量

清洗设备再把本次的连接交给后方的服务器正常通信

如果对方不硬打

清洗设备该重试重试

超时之后就断开连接

但因为清洗设备人高马大

作为专门应对攻击的角色

对连接资源做了极大的专门优化

能应对极其海量的连接请求

所以攻击者想要通过SYN洪水打垮它非常困难

再比如威胁极大的HTTP洪水攻击

正常来说一个HTTP请求

很难用传统的方式检测出是恶意流量还是正常流量

而清洗设备往往会提供专业的流量清洗平台

这些专业做流量清洗的服务商

通过多年和DDoS攻击的对抗

积累了大量的经验和技术

比如由于HTTP无法伪造IP地址

所以通过多年的数据积累建立IP信用库

从那些经常发起攻击的臭名昭著的IP发来的流量

就会被过滤掉

这有点像现在安卓手机上的来电标记

这是流量清洗厂商在数据积累上的优势

再比如恶意流量由于是通过程序自动发出

而不是人类的操作

所以利用算法对流量进行模式识别

就可以被检测出来

这是流量清洗厂商在技术上的优势

但不论怎样

DDoS作为一种历史悠久

但破坏能力巨大的黑客攻击手段

时至今日还是无法被彻底解决

或许你可以说DDoS攻击源自于

互联网通信构架在设计之初考虑的缺失

而人们现在又缺乏壮士断腕的决心

从根本上消灭它

但不论怎样

这种破坏与对抗将长久地存在于

互联网世界之中

而我们能做的只是做好防护

保持警惕