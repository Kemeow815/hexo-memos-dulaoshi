---
title: Linux 服务器安全加固参考
tags:
  - 安全
categories:
  - 网络安全
date: 2023-07-14 00:00:00
---

> 杜老师出差回来了，刚好得空拜访了小伙伴们的网站，发现近期有些小伙伴的网站被攻击了。其实除了常见的 DDoS，还有一些技术流的攻击形式，主要是通过系统和服务漏洞进行攻击。今天杜老师分享 Linux 服务器安全加固项，供需要的小伙伴们参考。

<!-- more -->

## 高危

高危加固项如下表：

检测类型：Redis安全检测
配置建议：
1、若非必要，请勿将Redis的bind配置为0.0.0.0
2、若bind为0.0.0.0的情况下，请务必为Redis设置访问密码
3、请勿使用过于简单的密码作为Redis访问密码
4、推荐使用高安全强度的密码：分别包含数字、大小写、特殊字符混合，且长度不少于7位。
5、Redis一但出现安全问题，这将大概率导致服务器被入侵，请务必认真处理

检测类型：CVE-2023-0386 Linux Kernel OverlayFS 权限提升漏洞漏洞检测
配置建议：
1、根据提示检查内核版本是否低于指定版本【uname -r】
2、若是CentOS 8 Stream，则执行【yum install kernel】命令升级内核版本，并重启服务器
3、若是Ubuntu 22.04，则执行【apt install linux-image】查看可安装版本号，选择高于5.15.0-70的版本号，再次执行【apt install linux-image-版本号】，并重启服务器

检测类型：tomcat后台访问弱口令检测
配置建议：
1、在【/usr/local/bttomcat/tomcat/conf/tomcat-users.xml】中修改password弱口令

检测类型：PHP存在版本泄露
配置建议：
1、在【php.ini】文件中设置【expose_php】将配置为Off
2、提示：【expose_php】将配置为Off

检测类型：strace获取登录凭证后门检测
配置建议：
1、ps aux命令查看是否存在通过strace读取sshd登录凭证
2、ps aux | grep strace
3、若筛选出进程，则使用kill -9 【pid】命令停止进程

检测类型：系统后门用户检测
配置建议：
1、在命令行中删除后门用户
2、注意：如果存在后门用户说明你服务器已经被入侵

检测类型：Docker API 未授权访问
配置建议：
1、应开启认证来鉴权或关闭Dokcer Api

检测类型：数据库备份权限检测
配置建议：
1、临时以无授权方式进入数据库，建议恢复root用户所有权限。

检测类型：禁止SSH空密码登录
配置建议：
1、在【/etc/ssh/sshd_config】文件中设置【PermitEmptyPasswords】将配置为no
2、提示：【PermitEmptyPasswords】将配置为no

检测类型：PHP未禁用危险函数
配置建议：
1、在【php.ini】文件中设置【disable_functions】未配置system,exec,passthru,shell_exec,popen,proc_open等危险函数
2、提示：【php.ini】未配置system,exec,passthru,shell_exec,popen,proc_open等危险函数

## 中危

中危加固项如下表：

检测类型：/etc/bashrc用户缺省权限检查
配置建议：
1、【/etc/bashrc】 文件中所所设置的umask为002,不符合要求，建议设置为027
2、操作如下：修改 umask 为027

检测类型：/etc/csh.cshrc用户缺省权限检查
配置建议：
1、【/etc/csh.cshrc】 文件中所所设置的umask为002,不符合要求，建议设置为027
2、操作如下：修改 umask 为027

检测类型：Apache 版本泄露
配置建议：
1、在【httpd.conf】文件中添加ServerSignature Off以及ServerTokens Prod

检测类型：SSH过期提前警告天数
配置建议：
1、在【/etc/login.defs】 PASS_WARN_AGE 大于等于7
2、提示：PASS_WARN_AGE 30 同时执行命令使root用户设置生效 chage --warndays 7 root

检测类型：开启地址空间布局随机化
配置建议：
1、【/proc/sys/kernel/randomize_va_space】 值为2：
2、操作如下：sysctl -w kernel.randomize_va_space=2

检测类型：关闭非加密远程管理telnet
配置建议：
1、尽可能使用加密远程管理sshd服务，关闭不安全的telnet服务
2、systemctl stop telnet.socket停止telnet服务

检测类型：检查临时目录是否有粘滞位
配置建议：
1、使用chmod +t 【文件名】命令修改文件的权限

检测类型：SSH 最大连接数检测
配置建议：
1、在【/etc/ssh/sshd_config】文件中设置【MaxAuthTries】为3-5
2、提示：SSH最大连接数为：3-6，请设置为3-5

检测类型：SSH密码长度度检查
配置建议：
1、【/etc/security/pwquality.conf】 文件中把minlen(密码最小长度)设置为9-32位
2、minlen=9

检测类型：/etc/profile用户缺省权限检查
配置建议：
1、【/etc/profile】 文件中所设置的umask为002,不符合要求，建议设置为027
2、操作如下：修改 umask 为027

检测类型：网站证书到期检测
配置建议：
1、请为您的站点续签或更换新的SSL证书，以免影响网站正常访问
2、SSL证书过期后，用户访问网站将被浏览器提示为不安全，且大部分浏览器会阻止访问，严重影响线上业务

检测类型：检查是否设置命令行界面超时退出
配置建议：
1、在文件【/etc/profile】中添加tmout=300，等保要求不大于600秒
2、执行命令source /etc/profile使配置生效

检测类型：bootloader配置权限
配置建议：
1、对【/boot/grub2/grub.cfg】文件，配置对应权限
2、chmod 600 /boot/grub2/grub.cfg、chown root /boot/grub2/grub.cfg

检测类型：SSH密码复杂度检查
配置建议：
1、【/etc/security/pwquality.conf】 把minclass（至少包含小写字母、大写字母、数字、特殊字符等4类字符中等3类或4类）设置为3或4。如：
2、minclass=3

检测类型：检查密码重复使用次数限制
配置建议：
1、配置文件备份cp -p /etc/pam.d/system-auth /etc/pam.d/system-auth.bak
2、在【/etc/pam.d/system-auth】文件【password sufficient】后面添加或修改remember=5

检测类型：SSH 空闲超时时间检测
配置建议：
1、在【/etc/ssh/sshd_config】文件中设置【ClientAliveInterval】设置为600到900之间
2、提示：SSH空闲超时时间建议为：600-900

检测类型：检查拥有suid和sgid权限的文件
配置建议：
1、使用chmod u-s/g-s 【文件名】命令修改文件的权限

检测类型：是否使用加密的远程管理ssh
配置建议：
1、在【/etc/ssh/sshd_config】文件中添加或修改Protocol 2
2、随后执行命令systemctl restart sshd重启进程

检测类型：检查SSH密码修改最小间隔
配置建议：
1、【/etc/login.defs】 PASS_MIN_DAYS 应设置为大于等于7
2、PASS_MIN_DAYS 7 需同时执行命令设置root 密码失效时间 命令如下: chage --mindays 7 root

检测类型：检查SSH密码失效时间
配置建议：
1、【/etc/login.defs】 使用非密码登陆方式密钥对。请忽略此项, 在/etc/login.defs 中将PASS_MAX_DAYS 参数设置为90-180之间
2、PASS_MAX_DAYS 90 需同时执行命令设置root密码到期时间 命令如下: chage --maxdays 90 root

## 低危

低危加固项如下表：

检测类型：TCP-SYNcookie保护检测
配置建议：
1、在【/etc/sysctl.conf】文件中添加net.ipv4.tcp_syncookies=1
2、然后执行命令sysctl -p生效配置

检测类型：检查别名配置
配置建议：
1、在文件【~/.bashrc】中添加或修改alias ls='ls -alh'以及alias rm='rm -i'
2、执行【source ~/.bashrc】使配置生效

检测类型：检查是否禁用whell组外的用户su为root
配置建议：
1、在文件【/etc/pam.d/su】中添加auth sufficient pam_rootok.so以及auth required pam_wheel.so group=wheel
2、如需配置用户可以切换为root，则将用户加入wheel组，使用命令gpasswd -a username wheel

检测类型：网站证书(SSL)
配置建议：
1、请考虑为您的网站部署SSL证书，以提升网站的安全性

检测类型：ssh访问控制列表检查
配置建议：
1、在【/etc/hosts.deny】添加ALL:ALL
2、在【/etc/hosts.allow】添加sshd:【来访者IP地址】

## 注意

1. 杜老师并未对以上服务进行分类，需要的小伙伴可以按需查找；

2. 以上加固项按杜老师服务器配置分享，部分服务如未安装则不需要加固；

3. 有参考范围的，则按需要配置，如不知该如何配置，可以取中；

4. 如果需要更多的安全加固项，可在评论区中留言。